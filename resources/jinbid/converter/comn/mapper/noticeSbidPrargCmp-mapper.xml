<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="jinbid.converter.comn.mapper.NoticeSbidPrargCmpDao">

    <!--        공고낙찰예정업체를 조회한다.    -->
    <select id="selectNoticeSbidPrargCmp" parameterType="long" resultType="jinbid.converter.comn.vo.NoticeSbidPrargCmp">
    	SELECT
    		ID	, /* ID */
			NOTI_ID,	/* 공고 ID */
			CMP_NM, /* 업체명 */
			RPSNTV_NM,	 /* 대표자명 */
			BIZ_NO, /* 사업자번호 */
			BDDPR_AMT,	 /* 투찰금액 */
			LAST_SBID_YN,	 /* 최종낙찰여부 */
			DATE_FORMAT(LAST_SBID_DT, '%Y-%m-%d %H:%i:%s') AS LAST_SBID_DT, /* 최종낙찰일시 */
			DATE_FORMAT(FIRST_INPUT_DT, '%Y-%m-%d %H:%i:%s') AS FIRST_INPUT_DT, /* 최초입력일시 */
			FIRST_INPTPS, /* 최초입력자 */
			DATE_FORMAT(LAST_UPDT_DT, '%Y-%m-%d %H:%i:%s') AS LAST_UPDT_DT, /* 최종수정일시 */
			LAST_AMNDR, /* 최종수정자 */
			USE_YN /* 사용여부 */
		FROM
			SY_NOTI.NOTI_SBID_PRARG_CMP
		WHERE 1
		AND NOTI_ID = #{notiId}
		AND USE_YN = 'Y'
    
    </select>

    <!--        공고낙찰예정업체를 입력한다.    -->
<!--     <insert id="insertNoticeSbidPrargCmp" parameterType="jinbid.converter.comn.vo.NoticeSbidPrargCmp" > -->
    <insert id="insertNoticeSbidPrargCmp" parameterType="Map" >
				INSERT INTO NOTI_SBID_PRARG_CMP
				
				(`NOTI_ID`,
				`CMP_NM`,
				`RPSNTV_NM`,
				`BIZ_NO`,
				`BDDPR_AMT`,
				`LAST_SBID_YN`,
				`LAST_SBID_DT`,
				`FIRST_INPUT_DT`,
				`FIRST_INPTPS`,
				`LAST_UPDT_DT`,
				`LAST_AMNDR`,
				`USE_YN`)
			<foreach collection='list'  item='Sbid' separator=" , ">	
				VALUES
				(   #{Sbid.notiId},
					#{Sbid.cmpNm},
					#{Sbid.rpsntvNm},
					#{Sbid.bizNo},
					#{Sbid.bddprAmt},
					#{Sbid.lastSbidYn},
					#{Sbid.lastSbidDt},
	                now(),
                	'batch2_insert',
                	now(),
                	'batch2_insert',
					'Y')
		</foreach>
    </insert>
  
</mapper>